<!DOCTYPE html>
<html lang="en">
<head>
    <title>Your Cart - Elite Science Institute</title>
    </head>
<body class="bg-slate-50">

    <main>
        <section id="cart" class="py-20 md:py-24">
            <div class="container mx-auto px-6 max-w-4xl">
                <h2 class="text-3xl md:text-4xl font-bold section-title mb-8">Your Shopping Cart</h2>
                
                <div id="cart-items-container" class="bg-white rounded-xl shadow-lg">
                    </div>
                
                <div class="mt-8 bg-white rounded-xl shadow-lg p-6">
                    <div class="flex justify-between items-center">
                        <span class="text-xl font-medium text-gray-600">Total:</span>
                        <span id="cart-total" class="text-3xl font-bold text-slate-800">₹0.00</span>
                    </div>
                    <button id="checkout-btn" class="mt-6 w-full bg-green-600 text-white py-4 rounded-lg font-semibold transition duration-300 hover:bg-green-700 text-lg">
                        Proceed to Checkout
                    </button>
                </div>

            </div>
        </section>
    </main>

    <script type="module" src="app.js"></script>
    
    <script type="module">
        import { getCartItems, removeFromCart, updateQuantity, getCartTotal } from './cart.js';

        const container = document.getElementById('cart-items-container');
        const totalEl = document.getElementById('cart-total');
        const checkoutBtn = document.getElementById('checkout-btn');

        function renderCart() {
            const items = getCartItems();
            container.innerHTML = ''; // Clear existing items

            if (items.length === 0) {
                container.innerHTML = '<p class="p-8 text-center text-gray-500">Your cart is empty.</p>';
                checkoutBtn.disabled = true;
                checkoutBtn.classList.add('opacity-50', 'cursor-not-allowed');
                totalEl.textContent = '₹0.00';
                return;
            }

            checkoutBtn.disabled = false;
            checkoutBtn.classList.remove('opacity-50', 'cursor-not-allowed');

            items.forEach((item, index) => {
                const itemEl = document.createElement('div');
                itemEl.className = 'flex flex-col md:flex-row items-center justify-between p-6';
                // Add border bottom to all except the last item
                if (index < items.length - 1) {
                    itemEl.classList.add('border-b', 'border-gray-200');
                }

                itemEl.innerHTML = `
                    <div class="flex items-center mb-4 md:mb-0">
                        <img src="${item.image}" alt="${item.name}" class="w-20 h-20 object-cover rounded-lg mr-4">
                        <div>
                            <h3 class="font-bold text-lg text-slate-800">${item.name}</h3>
                            <p class="text-gray-600">₹${item.price.toFixed(2)}</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center border rounded-lg">
                            <button class="quantity-change-btn p-2" data-id="${item.id}" data-change="-1">
                                <i class="fas fa-minus text-sm"></i>
                            </button>
                            <input type="number" value="${item.quantity}" min="1" class="w-16 text-center border-l border-r quantity-input" data-id="${item.id}">
                            <button class="quantity-change-btn p-2" data-id="${item.id}" data-change="1">
                                <i class="fas fa-plus text-sm"></i>
                            </button>
                        </div>
                        <p class="text-lg font-semibold w-24 text-right">₹${(item.price * item.quantity).toFixed(2)}</p>
                        <button class="remove-item-btn text-red-500 hover:text-red-700 p-2" data-id="${item.id}">
                            <i class="fas fa-trash-alt text-lg"></i>
                        </button>
                    </div>
                `;
                container.appendChild(itemEl);
            });

            // Add event listeners for new buttons
            container.querySelectorAll('.remove-item-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    removeFromCart(btn.dataset.id);
                    renderCart();
                });
            });

            container.querySelectorAll('.quantity-change-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const id = btn.dataset.id;
                    const change = parseInt(btn.dataset.change);
                    const currentItem = getCartItems().find(i => i.id === id);
                    updateQuantity(id, currentItem.quantity + change);
                    renderCart();
                });
            });

            container.querySelectorAll('.quantity-input').forEach(input => {
                input.addEventListener('change', (e) => {
                    const id = input.dataset.id;
                    const newQuantity = parseInt(e.target.value);
                    if (newQuantity) {
                        updateQuantity(id, newQuantity);
                        renderCart();
                    }
                });
            });
            
            // Update total
            totalEl.textContent = `₹${getCartTotal().toFixed(2)}`;
        }

        checkoutBtn.addEventListener('click', () => {
            window.location.href = 'checkout.html';
        });

        // Initial render
        renderCart();
    </script>
</body>
</html>
